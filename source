local NotificationLibrary = {}
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local STYLES = {
    Success = {
        MainColor = Color3.fromRGB(46, 213, 115),
        Icon = "rbxassetid://10747384390",
        Gradient = {
            Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, Color3.fromRGB(46, 213, 115)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(32, 178, 100))
            },
            Rotation = 90
        },
        ParticleColor = Color3.fromRGB(46, 213, 115)
    },
    Error = {
        MainColor = Color3.fromRGB(255, 71, 87),
        Icon = "rbxassetid://10747384876",
        Gradient = {
            Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 71, 87)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(214, 48, 49))
            },
            Rotation = 90
        },
        ParticleColor = Color3.fromRGB(255, 71, 87)
    },
    Warning = {
        MainColor = Color3.fromRGB(255, 165, 0),
        Icon = "rbxassetid://10747385123",
        Gradient = {
            Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 165, 0)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 140, 0))
            },
            Rotation = 90
        },
        ParticleColor = Color3.fromRGB(255, 165, 0)
    },
    Info = {
        MainColor = Color3.fromRGB(0, 168, 255),
        Icon = "rbxassetid://10747385345",
        Gradient = {
            Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 168, 255)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 120, 215))
            },
            Rotation = 90
        },
        ParticleColor = Color3.fromRGB(0, 168, 255)
    },
    Premium = {
        MainColor = Color3.fromRGB(156, 39, 176),
        Icon = "rbxassetid://10747385567",
        Gradient = {
            Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 64, 129)),
                ColorSequenceKeypoint.new(0.5, Color3.fromRGB(156, 39, 176)),
                ColorSequenceKeypoint.new(1, Color3.fromRGB(103, 58, 183))
            },
            Rotation = 90
        },
        ParticleColor = Color3.fromRGB(238, 130, 238)
    }
}

local PlayerGui = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui")
local NotificationScreen = Instance.new("ScreenGui")
NotificationScreen.Name = "PremiumNotifications"
NotificationScreen.Parent = PlayerGui
NotificationScreen.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
NotificationScreen.ResetOnSpawn = false

local function CreateParticles(parent, color)
    local particleEmitter = Instance.new("ParticleEmitter")
    particleEmitter.Parent = parent
    particleEmitter.LightEmission = 0.5
    particleEmitter.Color = ColorSequence.new(color)
    particleEmitter.Size = NumberSequence.new(0.2)
    particleEmitter.Texture = "rbxassetid://9872478095"
    particleEmitter.Lifetime = NumberRange.new(1, 1.5)
    particleEmitter.Rate = 15
    particleEmitter.Rotation = NumberRange.new(0, 360)
    particleEmitter.RotSpeed = NumberRange.new(-30, 30)
    particleEmitter.Speed = NumberRange.new(2, 5)
    particleEmitter.SpreadAngle = Vector2.new(45, 45)
    particleEmitter.Shape = Enum.ParticleEmitterShape.Disc
    particleEmitter.EmissionDirection = Enum.NormalId.Top
    particleEmitter.Enabled = false
    
    return particleEmitter
end

function NotificationLibrary.Notify(title, message, style, duration, options)
    -- Настройки по умолчанию
    style = style or "Info"
    duration = duration or 5
    options = options or {}
    
    local styleConfig = STYLES[style] or STYLES.Info
    
    local notification = Instance.new("Frame")
    notification.Name = "Notification_"..style
    notification.Parent = NotificationScreen
    notification.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    notification.Position = UDim2.new(1, 10, 0.7, 0)
    notification.Size = UDim2.new(0, 350, 0, 0)
    notification.AnchorPoint = Vector2.new(1, 0)
    notification.ClipsDescendants = true
    notification.ZIndex = 10
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 14)
    corner.Parent = notification
    
    local stroke = Instance.new("UIStroke")
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    stroke.Color = styleConfig.MainColor
    stroke.LineJoinMode = Enum.LineJoinMode.Round
    stroke.Thickness = 2
    stroke.Transparency = 0
    stroke.Parent = notification
    
    local gradient = Instance.new("UIGradient")
    gradient.Color = styleConfig.Gradient.Color
    gradient.Rotation = styleConfig.Gradient.Rotation
    gradient.Parent = stroke
    
    local glow = Instance.new("ImageLabel")
    glow.Name = "Glow"
    glow.Parent = notification
    glow.BackgroundTransparency = 1
    glow.Size = UDim2.new(1, 40, 1, 40)
    glow.Position = UDim2.new(0.5, -20, 0.5, -20)
    glow.AnchorPoint = Vector2.new(0.5, 0.5)
    glow.Image = "rbxassetid://9872478095"
    glow.ImageColor3 = styleConfig.MainColor
    glow.ScaleType = Enum.ScaleType.Slice
    glow.SliceCenter = Rect.new(50, 50, 50, 50)
    glow.ZIndex = 0
    glow.ImageTransparency = 0.9
    
    local glowTween = TweenService:Create(glow, TweenInfo.new(2, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut, -1, true), {
        ImageTransparency = 0.7
    })
    
    local header = Instance.new("Frame")
    header.Name = "Header"
    header.Parent = notification
    header.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
    header.Size = UDim2.new(1, 0, 0, 50)
    header.ZIndex = 11
    
    local headerCorner = Instance.new("UICorner")
    headerCorner.CornerRadius = UDim.new(0, 12)
    headerCorner.Parent = header
    
    local icon = Instance.new("ImageLabel")
    icon.Name = "Icon"
    icon.Parent = header
    icon.BackgroundTransparency = 1
    icon.Position = UDim2.new(0, 15, 0.5, -15)
    icon.Size = UDim2.new(0, 30, 0, 30)
    icon.Image = styleConfig.Icon
    icon.ImageColor3 = Color3.fromRGB(255, 255, 255)
    icon.ZIndex = 12
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "Title"
    titleLabel.Parent = header
    titleLabel.BackgroundTransparency = 1
    titleLabel.Position = UDim2.new(0, 60, 0, 0)
    titleLabel.Size = UDim2.new(1, -100, 1, 0)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.Text = string.upper(title)
    titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    titleLabel.TextSize = 16
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.ZIndex = 12
    titleLabel.TextTransparency = 0.2
    
    local closeButton = Instance.new("ImageButton")
    closeButton.Name = "CloseButton"
    closeButton.Parent = header
    closeButton.BackgroundTransparency = 1
    closeButton.AnchorPoint = Vector2.new(1, 0.5)
    closeButton.Position = UDim2.new(1, -15, 0.5, 0)
    closeButton.Size = UDim2.new(0, 20, 0, 20)
    closeButton.Image = "rbxassetid://10747385901"
    closeButton.ImageColor3 = Color3.fromRGB(180, 180, 180)
    closeButton.ZIndex = 15
    
    closeButton.MouseEnter:Connect(function()
        TweenService:Create(closeButton, TweenInfo.new(0.2), {
            ImageColor3 = Color3.fromRGB(255, 80, 80),
            Rotation = 90,
            Size = UDim2.new(0, 22, 0, 22)
        }):Play()
    end)
    
    closeButton.MouseLeave:Connect(function()
        TweenService:Create(closeButton, TweenInfo.new(0.2), {
            ImageColor3 = Color3.fromRGB(180, 180, 180),
            Rotation = 0,
            Size = UDim2.new(0, 20, 0, 20)
        }):Play()
    end)
    
    local body = Instance.new("Frame")
    body.Name = "Body"
    body.Parent = notification
    body.BackgroundTransparency = 1
    body.Position = UDim2.new(0, 0, 0, 55)
    body.Size = UDim2.new(1, 0, 0, 0)
    body.ZIndex = 11
    
    local messageLabel = Instance.new("TextLabel")
    messageLabel.Name = "Message"
    messageLabel.Parent = body
    messageLabel.BackgroundTransparency = 1
    messageLabel.Position = UDim2.new(0, 15, 0, 10)
    messageLabel.Size = UDim2.new(1, -30, 0, 0)
    messageLabel.Font = Enum.Font.Gotham
    messageLabel.Text = message
    messageLabel.TextColor3 = Color3.fromRGB(220, 220, 220)
    messageLabel.TextSize = 14
    messageLabel.TextWrapped = true
    messageLabel.TextXAlignment = Enum.TextXAlignment.Left
    messageLabel.TextYAlignment = Enum.TextYAlignment.Top
    messageLabel.ZIndex = 12
    
    local textHeight = math.ceil(messageLabel.TextBounds.Y / 14) * 14 + 20
    messageLabel.Size = UDim2.new(1, -30, 0, textHeight)
    
    local totalHeight = 55 + textHeight + 15
    body.Size = UDim2.new(1, 0, 0, textHeight + 5)
    
    local particles = CreateParticles(notification, styleConfig.ParticleColor)
    
    local function Close()
        particles.Enabled = false
        
        local closeTween = TweenService:Create(notification, TweenInfo.new(0.4, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
            Position = UDim2.new(1.2, 0, notification.Position.Y.Scale, notification.Position.Y.Offset),
            BackgroundTransparency = 1,
            Size = UDim2.new(0, 350, 0, 0)
        })
        
        closeTween:Play()
        closeTween.Completed:Connect(function()
            notification:Destroy()
        end)
    end
    
    closeButton.MouseButton1Click:Connect(Close)
    
    notification.Size = UDim2.new(0, 350, 0, 0)
    
    local openTween = TweenService:Create(notification, TweenInfo.new(0.6, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Size = UDim2.new(0, 350, 0, totalHeight)
    })
    
    openTween:Play()
    glowTween:Play()
    task.wait(0.3)
    particles.Enabled = true
    
    TweenService:Create(titleLabel, TweenInfo.new(0.4), {
        TextTransparency = 0
    }):Play()
    
    if duration > 0 then
        task.delay(duration, function()
            if notification and notification.Parent then
                Close()
            end
        end)
    end
    
    return {
        Close = Close,
        Frame = notification
    }
end

function NotificationLibrary.Success(title, message, duration, options)
    return NotificationLibrary.Notify(title, message, "Success", duration, options)
end

function NotificationLibrary.Error(title, message, duration, options)
    return NotificationLibrary.Notify(title, message, "Error", duration, options)
end

function NotificationLibrary.Warning(title, message, duration, options)
    return NotificationLibrary.Notify(title, message, "Warning", duration, options)
end

function NotificationLibrary.Info(title, message, duration, options)
    return NotificationLibrary.Notify(title, message, "Info", duration, options)
end

function NotificationLibrary.Premium(title, message, duration, options)
    return NotificationLibrary.Notify(title, message, "Premium", duration, options)
end

return NotificationLibrary
